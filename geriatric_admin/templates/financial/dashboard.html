{% extends 'base.html' %}
{% load static %}

{% block title %}Dashboard Financiero{% endblock %}
{% block page_title %}Dashboard Financiero{% endblock %}
{% block page_subtitle %}Gestión y análisis financiero{% endblock %}

{% block header_actions %}
<a href="{% url 'financial_web:expense_list' %}" class="flex items-center bg-white hover:bg-slate-100 text-slate-600 font-semibold py-2 px-3 sm:px-4 rounded-lg border border-slate-300 shadow-sm transition-all duration-300 transform hover:scale-105">
    <span class="material-icons mr-2 text-base sm:text-lg">visibility</span>
    <span class="text-sm sm:text-base">Ver Gastos</span>
</a>
<a href="{% url 'financial_web:income_create' %}" class="flex items-center bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-3 sm:px-4 rounded-lg shadow-md transition-all duration-300 transform hover:scale-105">
    <span class="material-icons mr-2 text-base sm:text-lg">add</span>
    <span class="text-sm sm:text-base">Nuevo Ingreso</span>
</a>
{% endblock %}

{% block content %}
<!-- Acciones rápidas -->
{% if quick_actions %}
{% include 'components/quick_actions.html' with quick_actions=quick_actions %}
{% endif %}

<!-- Estadísticas principales -->
<div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-4 xl:grid-cols-8 gap-4 sm:gap-6 mb-8">
    <!-- INGRESOS MENSUALES -->
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-slate-500">INGRESOS {{ current_month_name|upper }}</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">${{ monthly_income|default:"0" }}</p>
        </div>
        <div class="bg-emerald-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-emerald-600 text-2xl sm:text-3xl">trending_up</span>
        </div>
    </div>
    
    <!-- GASTOS MENSUALES -->
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-rose-600">GASTOS {{ current_month_name|upper }}</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">${{ monthly_expenses|default:"0" }}</p>
        </div>
        <div class="bg-rose-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-rose-600 text-2xl sm:text-3xl">trending_down</span>
        </div>
    </div>
    
    <!-- BALANCE MENSUAL -->
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-indigo-600">BALANCE {{ current_month_name|upper }}</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">${{ monthly_balance|default:"0" }}</p>
        </div>
        <div class="bg-indigo-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-indigo-600 text-2xl sm:text-3xl">calendar_month</span>
        </div>
    </div>
    
    <!-- BALANCE ANUAL -->
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-purple-600">BALANCE ANUAL</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">${{ yearly_balance|default:"0" }}</p>
        </div>
        <div class="bg-purple-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-purple-600 text-2xl sm:text-3xl">calendar_today</span>
        </div>
    </div>
    
    <!-- INGRESOS ANUALES -->
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-slate-500">INGRESOS ANUALES</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">${{ yearly_income|default:"0" }}</p>
        </div>
        <div class="bg-sky-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-sky-600 text-2xl sm:text-3xl">account_balance_wallet</span>
        </div>
    </div>
    
    <!-- GASTOS ANUALES -->
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-blue-600">GASTOS ANUALES</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">${{ yearly_expenses|default:"0" }}</p>
        </div>
        <div class="bg-blue-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-blue-600 text-2xl sm:text-3xl">receipt_long</span>
        </div>
    </div>
    
    <!-- INVERSIONES -->
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-emerald-600">INVERSIONES</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">${{ total_investments|default:"0" }}</p>
        </div>
        <div class="bg-emerald-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-emerald-600 text-2xl sm:text-3xl">savings</span>
        </div>
    </div>
    
</div>

<!-- Contenido principal -->
<div class="content-card">
    <h2 class="text-lg font-semibold text-slate-700 mb-4">Transacciones Recientes</h2>
    {% if recent_transactions %}
    <div class="overflow-x-auto">
        <table class="table-modern">
            <thead>
                <tr>
                    <th>Descripción</th>
                    <th>Tipo</th>
                    <th>Categoría</th>
                    <th>Monto</th>
                    <th>Fecha</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                {% for transaction in recent_transactions %}
                <tr>
                    <td class="text-sm font-medium text-slate-900">{{ transaction.description|truncatechars:30 }}</td>
                    <td>
                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full {% if transaction.type == 'income' %}bg-green-100 text-green-800{% else %}bg-red-100 text-red-800{% endif %}">
                            {% if transaction.type == 'income' %}Ingreso{% else %}Gasto{% endif %}
                        </span>
                    </td>
                    <td>{{ transaction.category.name|default:"--" }}</td>
                    <td class="font-medium {% if transaction.type == 'income' %}text-green-600{% else %}text-red-600{% endif %}">
                        ${{ transaction.amount }}
                    </td>
                    <td>{{ transaction.date|date:"d/m/Y" }}</td>
                    <td>
                        <a href="{% if transaction.type == 'income' %}{% url 'financial_web:income_detail' transaction.id %}{% else %}{% url 'financial_web:expense_detail' transaction.id %}{% endif %}" class="text-indigo-600 hover:text-indigo-900 text-sm font-medium">
                            Ver detalles
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="flex flex-col items-center justify-center text-center text-slate-500 h-64">
        <span class="material-icons text-5xl sm:text-6xl text-slate-300">account_balance_wallet</span>
        <p class="mt-4 font-semibold">No hay transacciones recientes</p>
        <p class="text-sm">Las transacciones aparecerán aquí cuando se registren.</p>
    </div>
    {% endif %}
</div>
{% endblock %} 
