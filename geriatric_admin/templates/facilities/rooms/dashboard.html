{% extends 'base.html' %}
{% load static %}

{% block title %}Dashboard de Habitaciones{% endblock %}
{% block page_title %}Dashboard de Habitaciones{% endblock %}
{% block page_subtitle %}Vista general del estado de las habitaciones{% endblock %}

{% block header_actions %}
{% endblock %}

{% block content %}
<!-- Acciones rápidas -->
{% if quick_actions %}
{% include 'components/quick_actions.html' with quick_actions=quick_actions %}
{% endif %}

<!-- Estadísticas principales -->
<div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-4 xl:grid-cols-8 gap-4 sm:gap-6 mb-8">
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-slate-500">TOTAL HABITACIONES</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">{{ total_rooms|default:"0" }}</p>
        </div>
        <div class="bg-indigo-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-indigo-600 text-2xl sm:text-3xl">hotel</span>
        </div>
    </div>
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-emerald-600">DISPONIBLES</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">{{ available_rooms|default:"0" }}</p>
        </div>
        <div class="bg-emerald-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-emerald-600 text-2xl sm:text-3xl">check_circle_outline</span>
        </div>
    </div>
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-amber-600">MANTENIMIENTO</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">{{ maintenance_rooms|default:"0" }}</p>
        </div>
        <div class="bg-amber-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-amber-600 text-2xl sm:text-3xl">build</span>
        </div>
    </div>
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-rose-600">CUARENTENA</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">{{ quarantine_rooms|default:"0" }}</p>
        </div>
        <div class="bg-rose-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-rose-600 text-2xl sm:text-3xl">shield</span>
        </div>
    </div>
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-slate-500">TOTAL CAMAS</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">{{ total_beds|default:"0" }}</p>
        </div>
        <div class="bg-sky-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-sky-600 text-2xl sm:text-3xl">bed</span>
        </div>
    </div>
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-blue-600">OCUPADAS</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">{{ occupied_beds|default:"0" }}</p>
        </div>
        <div class="bg-blue-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-blue-600 text-2xl sm:text-3xl">person</span>
        </div>
    </div>
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-emerald-600">DISPONIBLES</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">{{ available_beds|default:"0" }}</p>
        </div>
        <div class="bg-emerald-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-emerald-600 text-2xl sm:text-3xl">check</span>
        </div>
    </div>
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-amber-600">OCUPACIÓN</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">{{ occupancy_rate|default:"0" }}%</p>
        </div>
        <div class="bg-amber-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-amber-600 text-2xl sm:text-3xl">percent</span>
        </div>
    </div>
</div>

<!-- Contenido principal -->
<div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
    <div class="lg:col-span-2 bg-white p-6 rounded-xl border border-slate-200 transition-shadow duration-300 hover:shadow-lg">
        <h2 class="text-lg font-semibold text-slate-700 mb-4">Ocupación por Piso</h2>
        {% if floor_stats %}
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-slate-200">
                <thead class="bg-slate-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Piso</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Habitaciones</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Total Camas</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Ocupadas</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Disponibles</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Ocupación</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-slate-200">
                    {% for floor in floor_stats %}
                    <tr class="hover:bg-slate-50">
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-900">{{ floor.floor }}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-500">{{ floor.total_rooms }}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-500">{{ floor.total_beds }}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-500">{{ floor.occupied_beds }}</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full {% if floor.available_beds == 0 %}bg-red-100 text-red-800{% elif floor.available_beds <= 2 %}bg-yellow-100 text-yellow-800{% else %}bg-green-100 text-green-800{% endif %}">
                                {{ floor.available_beds }}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="w-full bg-slate-200 rounded-full h-2">
                                <div class="h-2 rounded-full {% if floor.occupancy_rate >= 90 %}bg-red-500{% elif floor.occupancy_rate >= 70 %}bg-yellow-500{% else %}bg-green-500{% endif %}" style="width: {{ floor.occupancy_rate }}%">
                                </div>
                            </div>
                            <span class="text-xs text-slate-500">{{ floor.occupancy_rate }}%</span>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="flex flex-col items-center justify-center text-center text-slate-500 h-64">
            <span class="material-icons text-5xl sm:text-6xl text-slate-300 animate-pulse">maps_home_work</span>
            <p class="mt-4 font-semibold">No hay datos disponibles</p>
            <p class="text-sm">Crea habitaciones para ver las estadísticas por piso.</p>
        </div>
        {% endif %}
    </div>

</div>
{% endblock %} 
