{% extends 'base.html' %}
{% load static %}
{% load i18n %}

{% block title %}{% trans 'Dashboard de Reportes' %}{% endblock %}
{% block page_title %}{% trans 'Dashboard de Reportes' %}{% endblock %}
{% block page_subtitle %}{% trans 'Generación y gestión de reportes' %}{% endblock %}



{% block content %}
<!-- Header compartido -->
{% include 'components/dashboard_header.html' %}

<!-- Acciones rápidas -->
{% if quick_actions %}
{% include 'components/quick_actions.html' with quick_actions=quick_actions %}
{% endif %}

<!-- Estadísticas principales -->
<div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-4 xl:grid-cols-8 gap-4 sm:gap-6 mb-8">
    <!-- Total Reportes -->
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-slate-500">{% trans 'TOTAL REPORTES' %}</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">{{ total_reports|default:"0" }}</p>
        </div>
        <div class="bg-slate-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-slate-600 text-2xl sm:text-3xl">assessment</span>
        </div>
    </div>
    
    <!-- Completados -->
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-emerald-600">{% trans 'COMPLETADOS' %}</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">{{ completed_reports|default:"0" }}</p>
        </div>
        <div class="bg-emerald-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-emerald-600 text-2xl sm:text-3xl">check_circle</span>
        </div>
    </div>
    
    <!-- En Proceso -->
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-amber-600">{% trans 'EN PROCESO' %}</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">{{ in_progress_reports|default:"0" }}</p>
        </div>
        <div class="bg-amber-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-amber-600 text-2xl sm:text-3xl">schedule</span>
        </div>
    </div>
    
    <!-- Pendientes -->
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-rose-600">{% trans 'PENDIENTES' %}</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">{{ pending_reports|default:"0" }}</p>
        </div>
        <div class="bg-rose-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-rose-600 text-2xl sm:text-3xl">pending</span>
        </div>
    </div>
    
    <!-- Reportes Mensuales -->
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-slate-600">{% trans 'REPORTES MENSUALES' %}</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">{{ monthly_reports|default:"0" }}</p>
        </div>
        <div class="bg-slate-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-slate-600 text-2xl sm:text-3xl">calendar_month</span>
        </div>
    </div>
    
    <!-- Descargas -->
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-slate-600">{% trans 'DESCARGAS' %}</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">{{ total_downloads|default:"0" }}</p>
        </div>
        <div class="bg-slate-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-slate-600 text-2xl sm:text-3xl">download</span>
        </div>
    </div>
    
    <!-- Automáticos -->
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-emerald-600">{% trans 'AUTOMÁTICOS' %}</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">{{ automatic_reports|default:"0" }}</p>
        </div>
        <div class="bg-emerald-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-emerald-600 text-2xl sm:text-3xl">auto_awesome</span>
        </div>
    </div>
    
    <!-- Manuales -->
    <div class="stat-card col-span-2 sm:col-span-1 xl:col-span-2">
        <div>
            <p class="text-xs sm:text-sm font-medium text-slate-600">{% trans 'MANUALES' %}</p>
            <p class="text-2xl sm:text-3xl font-bold text-slate-800">{{ manual_reports|default:"0" }}</p>
        </div>
        <div class="bg-slate-100 p-2 sm:p-3 rounded-full">
            <span class="material-icons text-slate-600 text-2xl sm:text-3xl">edit</span>
        </div>
    </div>
</div>

<!-- Contenido principal -->
<div class="w-full">
    <!-- Lista de Reportes Recientes -->
    <div class="bg-white rounded-2xl shadow-xl border border-slate-100 overflow-hidden">
        <div class="bg-gradient-to-r from-slate-500 to-slate-600 px-6 py-4">
            <h3 class="text-lg font-semibold text-white flex items-center">
                <span class="material-icons mr-2">history</span>
                {% trans 'Reportes Recientes' %}
            </h3>
        </div>
        <div class="p-6">
            {% if recent_reports %}
                <div class="space-y-4">
                    {% for report in recent_reports %}
                    <div class="flex items-center justify-between p-4 bg-gradient-to-r from-slate-50 to-slate-100 rounded-lg border border-slate-200 hover:from-slate-100 hover:to-slate-200 transition-all duration-300">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-slate-100 rounded-full flex items-center justify-center mr-4">
                                <span class="material-icons text-slate-600">assessment</span>
                            </div>
                            <div>
                                <h4 class="font-semibold text-slate-800">{{ report.title }}</h4>
                                <p class="text-sm text-slate-600">{{ report.description|truncatechars:60 }}</p>
                                <div class="flex items-center mt-1">
                                    <span class="text-xs text-slate-500">{{ report.created_at|date:"d/m/Y H:i" }}</span>
                                    <span class="mx-2 text-slate-300">•</span>
                                    <span class="text-xs text-slate-500">{{ report.get_report_type_display }}</span>
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="px-2 py-1 text-xs font-medium rounded-full 
                                {% if report.status == 'completed' %}bg-emerald-100 text-emerald-700
                                {% elif report.status == 'processing' %}bg-amber-100 text-amber-700
                                {% elif report.status == 'pending' %}bg-slate-100 text-slate-700
                                {% else %}bg-rose-100 text-rose-700{% endif %}">
                                {{ report.get_status_display }}
                            </span>
                            <a href="{% url 'reporting_web:report_detail' report.id %}" 
                               class="text-slate-600 hover:text-slate-800 transition-colors">
                                <span class="material-icons">visibility</span>
                            </a>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div class="mt-6 text-center">
                    <a href="{% url 'reporting_web:report_list' %}" 
                       class="inline-flex items-center px-4 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 transition-all duration-300">
                        <span class="material-icons mr-2">list</span>
                        {% trans 'Ver todos los reportes' %}
                    </a>
                </div>
            {% else %}
                <div class="text-center py-8">
                    <div class="w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="material-icons text-slate-400 text-2xl">assessment</span>
                    </div>
                    <h4 class="text-lg font-semibold text-slate-800 mb-2">{% trans 'No hay reportes recientes' %}</h4>
                    <p class="text-slate-600 mb-4">{% trans 'Crea tu primer reporte para comenzar' %}</p>
                    <a href="{% url 'reporting_web:report_create' %}" 
                       class="inline-flex items-center px-4 py-2 bg-slate-500 text-white rounded-lg hover:bg-slate-600 transition-all duration-300">
                        <span class="material-icons mr-2">add</span>
                        {% trans 'Crear Reporte' %}
                    </a>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %} 
